---
title: "CIHR Data Import"
output: html_notebook
author: "Leonard"
---

```{r}
library(rvest)
library(dplyr)
library(haven)

# store all csv file names
csv_files <- list.files("C:/Users/Leo/OneDrive/SICSS_R_Project/DataCIHR", pattern = "*.csv")


# load csv files and merge them into one dataframe
cihr_data <- data.frame()  
setwd("C:/Users/Leo/OneDrive/SICSS_R_Project/DataCIHR")

for (file in csv_files) {
  file_path <- file
  csv_data <- read.csv(file_path)
  cihr_data <- bind_rows(cihr_data, csv_data)
}



# Data filtering/restructuring 
cihr <- cihr_data %>% 
  select(Abstract.Résumé, Key.Clé, Name.Nom, OrgNm, ProvinceEN, CountryEN,
         CompetitionYear.AnnéeDuConcours, FiscalYear.AnnéeFinancière,
         AwardAmountinFY.MontantSubventiondeAF, TotalAwardAmount.MontantSubventionTotal,
         ProgramIDProgramme, ProgramNameEN, FundingTypeEN, AreasOfScienceEN, ResearchClassEN,
         TitreApplicationTitle, Keywords.MotsClés) %>% 
  rename(abstract = Abstract.Résumé,
         key = Key.Clé,
         name = Name.Nom,
         organization = OrgNm,
         province = ProvinceEN,
         country = CountryEN,
         year_comp = CompetitionYear.AnnéeDuConcours, 
         year_fisc = FiscalYear.AnnéeFinancière, 
         programID = ProgramIDProgramme,
         program_name = ProgramNameEN,
         funding_type = FundingTypeEN,
         science_areas = AreasOfScienceEN,
         research_class = ResearchClassEN,
         title = TitreApplicationTitle,
         keywords = Keywords.MotsClés) %>%
  mutate(abstract = ifelse(nchar(abstract) <= 30, NA, abstract))



hist(cihr$year_comp)
```

